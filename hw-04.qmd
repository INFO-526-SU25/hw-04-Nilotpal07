---
title: "HW 04"
author: "Nilotpal Rajbongshi"
format:
  html:
    embed-resources: true
toc: true
---

## Setup

```{r setup}
if (!require("pacman")) 
  install.packages("pacman")

# use this line for installing/loading
pacman::p_load(tidyverse,
               tigris,
               sf,
               ggrepel)

options(tigris_use_cache = TRUE)

devtools::install_github("tidyverse/dsbox")

#| label: plot-az-counties
#| message: false
#| warning: false
options(tigris_use_cache = TRUE)
az_counties <- counties(state = "AZ", year = 2021, progress_bar = FALSE)
```


## 1 - A second chance

```{r}
```


## 2.  Arizona state of counties

```{r}
#| label: plot-az-counties
#| message: false
#| warning: false

# Clean up the names and remove the word "County"
az_counties <- az_counties %>%
  mutate(NAME = str_remove(NAME, " County"))

# Get centroids for labeling
az_centroids <- az_counties %>%
  st_centroid() %>%
  mutate(lon = st_coordinates(.)[, 1], lat = st_coordinates(.)[, 2])

# Plot Arizona Counties
ggplot(data = az_counties) +
  geom_sf(data = az_counties,
          fill = "gray90",
          color = "black") +
  geom_label_repel(
    data = az_centroids,
    aes(x = lon, y = lat, label = NAME),
    fill = "white",
    color = "black",
    label.size = 0.5,
    size = 3,
    segment.color = "black",
    segment.size = 0.5,
    force_pull = 1,
    min.segment.length = 0
  ) +
  labs(
    title = "Counties in Arizona State",
    caption = "Source: Shapefile obtained using {tigris} R package, v2.0.1",
    x = "Longitude",
    y = "Latitude"
  ) +
  theme_minimal() +
  theme(
    axis.title = element_text(color = "black", size = 12),
    axis.text = element_text(color = "black", size = 10),
    axis.caption = element_text(color = "black", size = 10)
  )
```

## 3.  Arizona state of population change

```{r}
#| label: label-me-3

```

## 4.  Arizona state of Indiginous Tribal Regions

## 5. Arizona state of patchwork
